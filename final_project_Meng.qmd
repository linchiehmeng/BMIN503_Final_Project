---
title: "Association of statin use with sarcopenia in older adults: a cross-sectional study"
subtitle: "BMIN503/EPID600 Final Project"
author: "Lin-Chieh Meng"
format: html
editor: visual
number-sections: true
embed-resources: true
---

------------------------------------------------------------------------

Use this template to complete your project throughout the course. Your Final Project presentation will be based on the contents of this document. Replace the title/name above and text below with your own, but keep the headers. Feel free to change the theme and other display settings, although this is not required.

## Overview {#sec-overview}

Give a brief a description of your project and its goal(s), what data you are using to complete it, and what two faculty/staff in different fields you have spoken to about your project with a brief summary of what you learned from each person. Include a link to your final project GitHub repository.

## Introduction {#sec-introduction}

Describe the problem addressed, its significance, and some background to motivate the problem. This should extend what is in the @sec-overview.

Explain why your problem is interdisciplinary, what fields can contribute to its understanding, and incorporate background related to what you learned from meeting with faculty/staff.

## Methods {#sec-methods}

Describe the data used and general methodological approach used to address the problem described in the @sec-introduction. Subsequently, incorporate full R code necessary to retrieve and clean data, and perform analysis. Be sure to include a description of code so that others (including your future self) can understand what you are doing and why.

```{r}
library(haven)
library(dplyr)
```

```{r}
#Read the raw data file (NHANES 2017-2018) from my GitHub repository, where the raw data has been uploaded.

alq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/ALQ_J.XPT")

bpq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/BPQ_J.XPT")

cdq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/CDQ_J.XPT")

dbq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/DBQ_J.XPT")

demo_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/DEMO_J.XPT")

diq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/DIQ_J.XPT")

dlq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/DLQ_J.XPT")

dxx_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/DXX_J.XPT")

hsq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/HSQ_J.XPT")

kiq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/KIQ_U_J.XPT")

osq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/OSQ_J.XPT")

paq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/PAQ_J.XPT")

rxq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/RXQ_RX_J.XPT")

smq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/SMQ_J.XPT")

whq_data <- read_xpt ("https://raw.githubusercontent.com/linchiehmeng/BMIN503_Final_Project/master/WHQ_J.XPT")
```

```{r}
#Data cleaning - step 1
#Select the necessary variables from each data file

#------------------------------Covariates------------------------------

#Demography
demo_data <- demo_data %>%
  rename(id = SEQN, interview_status= RIDSTATR, gender= RIAGENDR, age = RIDAGEYR, race = RIDRETH3, education = DMDEDUC2, marital = DMDMARTL, income = INDHHIN2) %>%
  select(id, interview_status, gender, age, race, education, marital, income )

#Alcohol use
alq_data <- alq_data %>%
  rename(id = SEQN, alcohol = ALQ111) %>%
  select(id, alcohol)

#Blood pressure and cholesterol 
bpq_data <- bpq_data %>%
  rename(id = SEQN, HPT = BPQ020, lipid = BPQ080) %>%
  select(id, HPT, lipid)

#Cardiovascular health
cdq_data <- cdq_data %>%
  rename(id = SEQN, cardio_health = CDQ001) %>%
  select(id, cardio_health)

#Diet behavior & nutrition
dbq_data <- dbq_data %>%
  rename(id = SEQN, diet= DBQ700) %>%
  select(id, diet)

#Diabetes
diq_data <- diq_data %>%
  rename(id = SEQN, diabetes= DIQ010) %>%
  select(id, diabetes)

#Disability & anxious & depression
dlq_data <- dlq_data %>%
  rename(id = SEQN, walk_dis= DLQ050, anxious = DLQ130, depression = DLQ170 ) %>%
  select(id, walk_dis, anxious, depression)

#Self-reported current health status
hsq_data <- hsq_data %>%
  rename(id = SEQN, health= HSD010) %>%
  select(id, health)

#Kidney disease
kiq_data <- kiq_data %>%
  rename(id = SEQN, CKD= KIQ022) %>%
  select(id, CKD)

#Osteoporosis
osq_data <- osq_data %>%
  rename(id = SEQN, fractured_hip= OSQ010A, fractured_wrist= OSQ010B , fractured_spine= OSQ010C) %>%
  select(id, fractured_hip, fractured_wrist, fractured_spine)

#Physical activity
paq_data <- paq_data %>%
  rename(id = SEQN, Physical= PAQ605 ) %>%
  select(id, Physical)

#Smoking
smq_data <- smq_data %>%
  rename(id = SEQN, Smoking= SMQ040) %>%
  select(id, Smoking)

#Height & Weight
whq_data <- whq_data %>%
  rename(id = SEQN, Height= WHD010, Weight = WHD020) %>%
  select(id, Height, Weight)

#---------------------------Exposure-------------------------------

#Statin use
rxq_data <- rxq_data %>%
  rename(id = SEQN, Drug= RXDDRUG) %>%
  select(id, Drug)

statin_users <- rxq_data  %>%
  filter(grepl("STATIN", Drug, ignore.case = TRUE)) %>%
  distinct(id, .keep_all = TRUE)

#---------------------------Outcome-------------------------------

#Appendicular muscle mass
dxx_data <- dxx_data %>%
  rename(id = SEQN, left_arm= DXDLALE , left_leg = DXDLLLE,  right_arm = DXDRALE,  right_leg = DXDRLLE ) %>%
  select(id, left_arm, left_leg, right_arm, right_leg)
```

## Results {#sec-results}

Describe your results and include relevant tables, plots, and code/comments used to obtain them. You may refer to the @sec-methods as needed. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.

## Conclusion

This the conclusion. The @sec-results can be invoked here.
